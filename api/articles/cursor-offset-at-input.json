{"title":"Javascript è·å–è¾“å…¥æ—¶çš„å…‰æ ‡ä½ç½®åŠåœºæ™¯é—®é¢˜","slug":"cursor-offset-at-input","date":"2016-11-25T02:02:01.000Z","updated":"2016-11-29T14:47:32.479Z","comments":true,"path":"api/articles/cursor-offset-at-input.json","excerpt":"<h2 id=\"å‰è¨€\"><a href=\"#å‰è¨€\" class=\"headerlink\" title=\"å‰è¨€\"></a>å‰è¨€</h2><p>åœ¨è¾“å…¥ç¼–è¾‘çš„ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œå¯èƒ½ä¼šéœ€è¦åœ¨å…‰æ ‡å½“å‰çš„ä½ç½®æˆ–é™„è¿‘æ˜¾ç¤ºæç¤ºé€‰é¡¹ã€‚<br>æ¯”å¦‚ç¤¾äº¤è¯„è®ºä¸­çš„<code>@user</code>åŠŸèƒ½ï¼Œè¦ç¡®ä¿æç¤ºçš„ç”¨æˆ·åˆ—è¡¨æ€»æ˜¯å‡ºç°åœ¨<code>@</code>å­—ç¬¦å³ä¸‹æ–¹ï¼Œåˆæˆ–è€…æ˜¯åœ¨è‡ªå®šä¹‰ç¼–è¾‘å™¨ä¸­ autocomplete è¯­æ³•æç¤ºï¼Œéƒ½éœ€è¦è·å–å…‰æ ‡å½“å‰çš„ä½ç½®ä½œä¸ºå‚ç…§ç‚¹ã€‚</p>","content":"<h2 id=\"å‰è¨€\"><a href=\"#å‰è¨€\" class=\"headerlink\" title=\"å‰è¨€\"></a>å‰è¨€</h2><p>åœ¨è¾“å…¥ç¼–è¾‘çš„ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œå¯èƒ½ä¼šéœ€è¦åœ¨å…‰æ ‡å½“å‰çš„ä½ç½®æˆ–é™„è¿‘æ˜¾ç¤ºæç¤ºé€‰é¡¹ã€‚<br>æ¯”å¦‚ç¤¾äº¤è¯„è®ºä¸­çš„<code>@user</code>åŠŸèƒ½ï¼Œè¦ç¡®ä¿æç¤ºçš„ç”¨æˆ·åˆ—è¡¨æ€»æ˜¯å‡ºç°åœ¨<code>@</code>å­—ç¬¦å³ä¸‹æ–¹ï¼Œåˆæˆ–è€…æ˜¯åœ¨è‡ªå®šä¹‰ç¼–è¾‘å™¨ä¸­ autocomplete è¯­æ³•æç¤ºï¼Œéƒ½éœ€è¦è·å–å…‰æ ‡å½“å‰çš„ä½ç½®ä½œä¸ºå‚ç…§ç‚¹ã€‚</p>\n<a id=\"more\"></a>\n<h2 id=\"ä¸¤ç§ä½ç½®\"><a href=\"#ä¸¤ç§ä½ç½®\" class=\"headerlink\" title=\"ä¸¤ç§ä½ç½®\"></a>ä¸¤ç§ä½ç½®</h2><p>å¯¹äº WEB å¼€å‘æ¥è®²ï¼Œå½“æˆ‘ä»¬æåˆ°æŸæŸå…ƒç´ çš„ä½ç½®ï¼Œé€šå¸¸æ˜¯æŒ‡è¿™ä¸ªå…ƒç´ ç›¸å¯¹äºçˆ¶çº§æˆ–æ–‡æ¡£çš„åƒç´ å•ä½åæ ‡ã€‚è€Œå¯¹äºè¾“å…¥æ¡†ä¸­å…‰æ ‡ï¼Œå°±æœ‰äº†é¢å¤–çš„åŒºåˆ†ã€‚</p>\n<h3 id=\"ç›¸å¯¹äºå†…å®¹\"><a href=\"#ç›¸å¯¹äºå†…å®¹\" class=\"headerlink\" title=\"ç›¸å¯¹äºå†…å®¹\"></a>ç›¸å¯¹äºå†…å®¹</h3><p>ç›¸å¯¹äºå†…å®¹ï¼Œå…‰æ ‡ä½äºç¬¬å‡ ä¸ªå­—ç¬¦ä¹‹åï¼Œå§‘ä¸”ç§°ä¹‹ä¸º<strong>å­—ç¬¦ä½ç½®</strong>å§ã€‚</p>\n<h3 id=\"ç›¸å¯¹äºUI\"><a href=\"#ç›¸å¯¹äºUI\" class=\"headerlink\" title=\"ç›¸å¯¹äºUI\"></a>ç›¸å¯¹äºUI</h3><p>ç›¸å¯¹äºUIï¼Œä¹Ÿå°±æ˜¯è·Ÿæ™®é€šé¡µé¢å…ƒç´ ä¸€æ ·çš„<strong>åƒç´ ä½ç½®</strong>äº†ã€‚</p>\n<h2 id=\"æ’å…¥æˆ–æ›¿æ¢å†…å®¹\"><a href=\"#æ’å…¥æˆ–æ›¿æ¢å†…å®¹\" class=\"headerlink\" title=\"æ’å…¥æˆ–æ›¿æ¢å†…å®¹\"></a>æ’å…¥æˆ–æ›¿æ¢å†…å®¹</h2><p>åœ¨å‰è¨€æåˆ°çš„åœºæ™¯ä¸­ï¼Œä¹Ÿæœ‰åœ¨å…‰æ ‡ä½ç½®å¤„æ’å…¥å†…å®¹çš„éœ€æ±‚ï¼Œæ¯”å¦‚å¯¹é€‰å–æ–‡å­—åŠ ç²—<code>text =&gt; &lt;strong&gt;text&lt;/strong&gt;</code>ç­‰ã€‚</p>\n<h3 id=\"textarea\"><a href=\"#textarea\" class=\"headerlink\" title=\"textarea\"></a>textarea</h3><p><code>textarea</code>å…ƒç´ å¯ä»¥å¾ˆå®¹æ˜“è·å–åˆ°é€‰æ‹©çš„ä¸€æ®µæ–‡å­—çš„èµ·æ­¢ä½ç½®ã€‚å¦‚æœå½“å‰æ²¡æœ‰é€‰æ‹©æ–‡å­—ï¼Œåˆ™ä¸¤ä¸ªä½ç½®å€¼éƒ½ä¸ºå…‰æ ‡å³ä¾§å­—ç¬¦çš„ç´¢å¼•ï¼Œä» 0 å¼€å§‹ã€‚</p>\n<figure class=\"highlight js\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// å¼€å§‹ä½ç½®</span></div><div class=\"line\">textarea.selectionStart</div><div class=\"line\"><span class=\"comment\">// ç»“æŸä½ç½®</span></div><div class=\"line\">textarea.selectionEnd</div></pre></td></tr></table></figure>\n<p>å¯¹äºåŠ ç²—åŠŸèƒ½ï¼Œæœ‰äº†èµ·æ­¢ä½ç½®ï¼Œå°±èƒ½è·å–åˆ°é€‰æ‹©çš„æ–‡å­—å†…å®¹ï¼Œç„¶åå¯¹å†…å®¹è¿›è¡Œæ›¿æ¢ã€‚<br>ç”±äº<code>textarea</code>ä¸èƒ½åŒ…å«å­å…ƒç´ ï¼Œåªæœ‰çº¯æ–‡æœ¬ï¼Œæ‰€ä»¥åŸºäº<code>textarea</code>å®ç°åŠ ç²—åªèƒ½åƒç”¨ Markdown æ ‡è®°è¯­æ³•å®ç°ã€‚</p>\n<figure class=\"highlight js\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> selectedText = textarea.value.substring(textarea.selectionStart, textarea.selectionEnd)</div><div class=\"line\">textarea.setRangeText(<span class=\"string\">'**'</span>+ selectedText +<span class=\"string\">'**'</span>)</div></pre></td></tr></table></figure>\n<blockquote>\n<p><code>textarea.setRangeText(text: String)</code> æŠŠé€‰ä¸­çš„æ–‡å­—æ›¿æ¢ä¸ºå…¶ä»–å†…å®¹ã€‚</p>\n</blockquote>\n<h3 id=\"contenteditable\"><a href=\"#contenteditable\" class=\"headerlink\" title=\"contenteditable\"></a>contenteditable</h3><p>ä¹Ÿå¯èƒ½æˆ‘ä»¬ä¼šä½¿ç”¨<code>contenteditable</code>å±æ€§æŠŠä¸€ä¸ªå…ƒç´ å˜ä¸ºå¯ç¼–è¾‘å…ƒç´ ã€‚è€Œä¸Šé¢æ‰€ç”¨çš„å±æ€§å’Œå‡½æ•°éƒ½æ˜¯æ™®é€šå…ƒç´ æ‰€æ²¡æœ‰çš„ï¼Œæ‰€ä»¥è¦æ¢ä¸€ç§å§¿åŠ¿å®ç°ã€‚</p>\n<p>è¿˜æ˜¯ä»¥åŠ ç²—åŠŸèƒ½ä¸ºä¾‹ã€‚</p>\n<figure class=\"highlight js\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// è·å–æ–‡æ¡£ä¸­é€‰ä¸­åŒºåŸŸ</span></div><div class=\"line\"><span class=\"keyword\">var</span> range = <span class=\"built_in\">window</span>.getSelection().getRangeAt(<span class=\"number\">0</span>)</div><div class=\"line\"><span class=\"keyword\">var</span> strongNode = <span class=\"built_in\">document</span>.createElement(<span class=\"string\">'strong'</span>)</div><div class=\"line\"><span class=\"comment\">// é€‰ä¸­åŒºåŸŸæ–‡æœ¬</span></div><div class=\"line\">strongNode.innerHTML = range.toString()</div><div class=\"line\"><span class=\"comment\">// åˆ é™¤é€‰ä¸­åŒº</span></div><div class=\"line\">range.deleteContents()</div><div class=\"line\"><span class=\"comment\">// åœ¨å…‰æ ‡å¤„æ’å…¥æ–°èŠ‚ç‚¹                    </span></div><div class=\"line\">range.insertNode(strongNode)</div></pre></td></tr></table></figure>\n<p>åŸºäº<code>contenteditable</code>çš„å¯ç¼–è¾‘å…ƒç´ ï¼Œå…¶ä¸­çš„å†…å®¹å‡ä¸ºå­å…ƒç´ ï¼Œæ–‡æœ¬ä¸º<code>textNode</code>ï¼ŒåŠ ç²—ä½¿ç”¨ HTML å…ƒç´ ï¼Œæ’å…¥æˆ–æ›¿æ¢æ˜¯å¯¹å…ƒç´ çš„æ“ä½œã€‚</p>\n<p>å¦‚æœæƒ³ä½¿ç”¨æ“ä½œå†…å®¹çš„æ€è·¯å®ç°ä¼šæ¯”è¾ƒéº»çƒ¦ï¼Œå› ä¸ºå¯ä»¥è·å–åˆ°çš„èµ·æ­¢ä½ç½®æ˜¯åŸºäºå­å…ƒç´ çš„ã€‚</p>\n<figure class=\"highlight html\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">contenteditable</span>&gt;</span>hello<span class=\"tag\">&lt;<span class=\"name\">strong</span>&gt;</span>ä½ å¥½<span class=\"tag\">&lt;/<span class=\"name\">strong</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">big</span>&gt;</span>w<span class=\"tag\">&lt;/<span class=\"name\">big</span>&gt;</span>orld<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div></pre></td></tr></table></figure>\n<p>å‡å¦‚é€‰ä¸­çš„æ–‡å­—æ˜¯<code>ä½ å¥½wor</code>ï¼Œè°ƒç”¨ç›¸å…³ API çš„è¾“å‡ºå¦‚ä¸‹ã€‚</p>\n<figure class=\"highlight js\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// å½“å‰åœ¨æ–‡æ¡£ä¸­é€‰æ‹©çš„æ–‡æœ¬ï¼Œdocument å’Œ window éƒ½æœ‰è¿™ä¸ªå‡½æ•°</span></div><div class=\"line\"><span class=\"comment\">// var selection = document.getSelection()</span></div><div class=\"line\"><span class=\"keyword\">var</span> selection = <span class=\"built_in\">window</span>.getSelection()</div><div class=\"line\">selection.anchorNode    <span class=\"comment\">// ä½ å¥½</span></div><div class=\"line\">selection.anchorOffset  <span class=\"comment\">// 0</span></div><div class=\"line\">selection.focusNode     <span class=\"comment\">// orld</span></div><div class=\"line\">selection.focusOffset   <span class=\"comment\">// 2</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// æˆ–è€…ä½¿ç”¨ Range</span></div><div class=\"line\"><span class=\"keyword\">var</span> range = selection.getRangeAt(<span class=\"number\">0</span>)</div><div class=\"line\">range.startContainer    <span class=\"comment\">// ä½ å¥½</span></div><div class=\"line\">range.startOffset       <span class=\"comment\">// 0</span></div><div class=\"line\">range.endContainer      <span class=\"comment\">// orld</span></div><div class=\"line\">range.endOffset         <span class=\"comment\">// 2</span></div></pre></td></tr></table></figure>\n<p>æœ€ç»ˆå¯ä»¥è·å–åˆ°èµ·æ­¢å…ƒç´ ä»¥åŠé€‰ä¸­åŒºåŸŸåœ¨å¼€å§‹å…ƒç´ å†…å®¹ä¸­çš„å­—ç¬¦ä½ç½®å’Œåœ¨ç»“æŸå…ƒç´ å†…å®¹ä¸­çš„å­—ç¬¦ä½ç½®ã€‚<br>å…¶ä¸­çš„èµ·æ­¢å…ƒç´ å‡ä¸º<code>textNode</code>ç±»å‹ï¼Œé€šè¿‡<code>parentNode</code>è·å–åˆ°åŒ…è£¹å…ƒç´ ã€‚</p>\n<figure class=\"highlight js\"><table><tr><td class=\"code\"><pre><div class=\"line\">range.startContainer.parentNode     <span class=\"comment\">// &lt;strong&gt;ä½ å¥½&lt;/strong&gt;</span></div><div class=\"line\">range.endContainer.parentNode       <span class=\"comment\">// &lt;div contenteditable&gt;...&lt;/div&gt;</span></div></pre></td></tr></table></figure>\n<blockquote>\n<p>éœ€è¦æ³¨æ„çš„æ˜¯é€šè¿‡<code>Selection</code>å’Œ<code>Rang</code>è·å–åˆ°èµ·æ­¢ä½ç½®æ˜¯æœ‰æ–¹å‘ä¹‹åˆ†çš„ï¼Œä»å·¦å‘å³é€‰æ‹©å’Œä»å³å‘å·¦é€‰æ‹©å¾—åˆ°çš„å€¼æ˜¯æ­£å¥½ç›¸åçš„ã€‚</p>\n</blockquote>\n<h2 id=\"åŸºäºå…‰æ ‡åƒç´ ä½ç½®åˆ›å»ºå†…å®¹\"><a href=\"#åŸºäºå…‰æ ‡åƒç´ ä½ç½®åˆ›å»ºå†…å®¹\" class=\"headerlink\" title=\"åŸºäºå…‰æ ‡åƒç´ ä½ç½®åˆ›å»ºå†…å®¹\"></a>åŸºäºå…‰æ ‡åƒç´ ä½ç½®åˆ›å»ºå†…å®¹</h2><p>è¿™é‡Œå°±è¦å¼€å§‹ç”¨åƒç´ ä½ç½®ï¼ŒåŒæ ·åˆ†ä¸ºä¸¤ç§å®ç°æ¥è®²ã€‚</p>\n<h3 id=\"contenteditable-1\"><a href=\"#contenteditable-1\" class=\"headerlink\" title=\"contenteditable\"></a>contenteditable</h3><p>å¯ç¼–è¾‘å…ƒç´ è·å–å…‰æ ‡åƒç´ ä½ç½®å°±åƒ<code>textarea</code>è·å–å…‰æ ‡çš„å­—ç¬¦ä½ç½®ä¸€æ ·ç®€å•ã€‚</p>\n<figure class=\"highlight js\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> range = <span class=\"built_in\">window</span>.getSelection().getRangeAt(<span class=\"number\">0</span>)</div><div class=\"line\">range.getBoundingClientRect()  <span class=\"comment\">// &#123; width, height, top, right, bottom, right &#125;</span></div></pre></td></tr></table></figure>\n<p>è¿™ä¹ˆå…·ä½“çš„å°ºå¯¸å€¼ï¼Œå®ç°è‡ªåŠ¨å®ŒæˆçœŸæ˜¯ So easy!</p>\n<h3 id=\"textarea-1\"><a href=\"#textarea-1\" class=\"headerlink\" title=\"textarea\"></a>textarea</h3><p><code>textarea</code>å…¶ä¸­çš„å†…å®¹éƒ½æ˜¯çº¯æ–‡æœ¬ï¼Œåœ¨ DOM ä¸­ä¸å­˜åœ¨ç›¸å…³çš„å¯¹è±¡ï¼Œå¯¹äºåƒç´ ä½ç½®å°±å¾—å¦ä½œä»–æƒ³äº†ã€‚</p>\n<h4 id=\"åŸºäºè¡Œé«˜å’Œå­—ä½“å¤§å°è®¡ç®—\"><a href=\"#åŸºäºè¡Œé«˜å’Œå­—ä½“å¤§å°è®¡ç®—\" class=\"headerlink\" title=\"åŸºäºè¡Œé«˜å’Œå­—ä½“å¤§å°è®¡ç®—\"></a>åŸºäºè¡Œé«˜å’Œå­—ä½“å¤§å°è®¡ç®—</h4><figure class=\"highlight js\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// 1.è·å–å…‰æ ‡ç»“æŸä½ç½®</span></div><div class=\"line\"><span class=\"keyword\">var</span> end = textarea.selectionEnd</div><div class=\"line\"><span class=\"comment\">// 2.é€šè¿‡åŒ¹é…å…‰æ ‡ä¹‹å‰æ–‡æœ¬ä¸­çš„æ¢è¡Œç¬¦è®¡ç®—æ‰€åœ¨è¡Œ</span></div><div class=\"line\"><span class=\"keyword\">var</span> row = textarea.value.substring(<span class=\"number\">0</span>, end).match(<span class=\"regexp\">/\\r\\n|\\r|\\n/</span>).length</div><div class=\"line\"><span class=\"comment\">// 3.è®¡ç®— topï¼Œè¡Œé«˜ * è¡Œæ•° + ä¸Šå¡«å…… + è¾¹æ¡†å®½åº¦</span></div><div class=\"line\"><span class=\"keyword\">var</span> top = lineHeight * (row + <span class=\"number\">1</span>) + paddingTop + borderWidth</div><div class=\"line\"><span class=\"comment\">// 4.è·å–å…‰æ ‡å·¦ä¾§çš„æ–‡æœ¬</span></div><div class=\"line\"><span class=\"keyword\">var</span> leftText = textarea.value.split(<span class=\"regexp\">/\\r\\n|\\r|\\n/</span>)[row]</div><div class=\"line\"><span class=\"comment\">// 5.å½±å“ä¸€æ®µæ–‡å­—æ‰€å å®½åº¦çš„å› ç´ å¤ªå¤šï¼Œé™¤å­—ä½“å¤§å°ã€ä¸­è‹±æ–‡ã€ç¬¦å·ã€å­—ç¬¦é—´è·ç­‰ï¼Œè¿˜æœ‰å­—ä½“ã€æµè§ˆå™¨ã€ç³»ç»Ÿç­‰å®¢è§‚å› ç´ </span></div><div class=\"line\"><span class=\"comment\">// var left = ...</span></div></pre></td></tr></table></figure>\n<p>è¿™ä¸ªæ–¹æ¡ˆçš„æ€è·¯æ˜¯æ²¡é—®é¢˜çš„ï¼Œä½†æ˜¯è€ƒè™‘æ‰€æœ‰é—®é¢˜çš„æˆæœ¬å¤ªé«˜ã€‚<br>è™½ç„¶å¯ä»¥åˆ›å»ºæµ‹è¯•å…ƒç´ å»è®¡ç®—æ–‡æœ¬å®½åº¦ï¼Œä½†è¿™ä¸ªæ–¹æ¡ˆæœ¬èº«æ˜¯ä»ä¸¥è°¨çš„è§’åº¦å‡ºå‘çš„ã€‚ä¸å…¶æ··åœ¨ä¸€å—ï¼Œç›´æ¥ç”¨å–å·§çš„åŠæ³•æ›´ç®€å•ã€‚</p>\n<blockquote>\n<p><del>è¿™ä¸ªæ–¹æ¡ˆçš„æ½œå°è¯æ˜¯ï¼šæ˜æ˜å¯ä»¥é è„¸åƒé¥­ï¼Œå´ååè¦é æ‰åï¼</del> ğŸ™„</p>\n</blockquote>\n<h4 id=\"é•œåƒå…ƒç´ \"><a href=\"#é•œåƒå…ƒç´ \" class=\"headerlink\" title=\"é•œåƒå…ƒç´ \"></a>é•œåƒå…ƒç´ </h4><p>æ–‡æœ¬ä¸æ”¯æŒå®šä½ï¼Ÿé‚£æˆ‘åˆ›å»º DOM å¥½äº†ã€‚</p>\n<figure class=\"highlight js\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// å…‰æ ‡ä½ç½®</span></div><div class=\"line\"><span class=\"keyword\">var</span> end = textarea.selectionEnd</div><div class=\"line\"><span class=\"comment\">// å…‰æ ‡å‰çš„å†…å®¹</span></div><div class=\"line\"><span class=\"keyword\">var</span> beforeText = textarea.value.slice(<span class=\"number\">0</span>, end)</div><div class=\"line\"><span class=\"comment\">// å…‰æ ‡åçš„å†…å®¹</span></div><div class=\"line\"><span class=\"keyword\">var</span> afterText = textarea.value.slice(end)</div><div class=\"line\"><span class=\"comment\">// å¯¹å½±å“ UI çš„ç‰¹æ®Šå…ƒç´ ç¼–ç </span></div><div class=\"line\"><span class=\"keyword\">var</span> <span class=\"built_in\">escape</span> = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">text</span>) </span>&#123; </div><div class=\"line\">    <span class=\"keyword\">return</span> text.replace(<span class=\"regexp\">/&lt;|&gt;|`|\"|&amp;/g</span>, <span class=\"string\">'?'</span>).replace(<span class=\"regexp\">/\\r\\n|\\r|\\n/g</span>, <span class=\"string\">'&lt;br&gt;'</span>)</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"comment\">// åˆ›å»ºé•œåƒå†…å®¹ï¼Œå¤åˆ¶æ ·å¼</span></div><div class=\"line\"><span class=\"keyword\">var</span> mirror = <span class=\"string\">'&lt;div class=\"'</span>+ textarea.className +<span class=\"string\">'\"&gt;'</span> </div><div class=\"line\">                + <span class=\"built_in\">escape</span>(beforeText) </div><div class=\"line\">                + <span class=\"string\">'&lt;span id=\"cursor\"&gt;|&lt;/span&gt;'</span> </div><div class=\"line\">                + <span class=\"built_in\">escape</span>(afterText) </div><div class=\"line\">            + <span class=\"string\">'&lt;/div&gt;'</span></div><div class=\"line\"><span class=\"comment\">// æ·»åŠ åˆ° textarea åŒçº§ï¼Œæ³¨æ„è®¾ç½®å®šä½åŠ zIndexï¼Œä½¿ä¸¤ä¸ªå…ƒç´ é‡åˆ</span></div><div class=\"line\">textarea.insertAdjacentHTML(<span class=\"string\">'afterend'</span>, mirror)</div><div class=\"line\"><span class=\"comment\">// é€šè¿‡é•œåƒå…ƒç´ ä¸­çš„å‡å…‰æ ‡å ä½å…ƒç´ è·å–åƒç´ ä½ç½®</span></div><div class=\"line\"><span class=\"keyword\">var</span> cursor = <span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'cursor'</span>)</div><div class=\"line\">cursor.getBoundingClientRect()  <span class=\"comment\">// &#123; width, height, top, right, bottom, right &#125;</span></div></pre></td></tr></table></figure>\n<h2 id=\"End\"><a href=\"#End\" class=\"headerlink\" title=\"End\"></a>End</h2><p>æœ€åæ‚„æ‚„è¯´ä¸€å¥ï¼Œä»¥ä¸Šå†…å®¹ä¸å…¼å®¹ä½ç‰ˆæœ¬ IEï¼Œä½†æ˜¯ IE æ¯•ç«Ÿä¸»åœºè¿è¡Œï¼Œæœ‰äº› API åè€Œæ˜¯å…¶ä»–æµè§ˆå™¨æ‰€æ²¡æœ‰çš„ã€‚å°±ä¸Šé¢æåˆ°çš„æ¡ˆä¾‹æ¥è¯´ï¼Œä½ç‰ˆæœ¬ IE ä¹Ÿæœ‰å¯¹åº”çš„ API å¯ç”¨ã€‚<br>çœŸæ˜¯ä¸æƒ³åœ¨ IE ä¸Šå»æµªè´¹ç²¾åŠ›äº†ï¼Œç´¢æ€§ä¸æã€‚</p>","categories":[],"tags":[{"name":"Javascript","path":"api/tags/Javascript.json"},{"name":"Range","path":"api/tags/Range.json"},{"name":"Selection","path":"api/tags/Selection.json"}]}