{"title":"Vueå•å…ƒæµ‹è¯•èµ·æ­¥","slug":"vue-unit-test-start","date":"2016-11-10T03:08:14.000Z","updated":"2017-08-20T13:57:23.874Z","comments":true,"path":"api/articles/vue-unit-test-start.json","excerpt":"<p>æœ€è¿‘åœ¨æ­å»ºä¸€ä¸ªé¡¹ç›®çš„å‰ç«¯å¼€å‘ç¯å¢ƒï¼Œå‡†å¤‡è¶æ­¤æŠŠä¸€äº›æ²¡ç”¨è¿‡çš„ä¸œè¥¿å°è¯•ä¸‹ï¼Œæ¯”å¦‚ï¼šå•å…ƒæµ‹è¯•ã€‚<br>ä½¿ç”¨<code>vue-cli</code>å¯ä»¥ç›´æ¥ç”Ÿæˆä¸€ä¸ªåŒ…å«<code>unit</code>ã€<code>e2e</code>æµ‹è¯•çš„å¼€å‘ç¯å¢ƒï¼Œä¸è¿‡è¿˜æ˜¯éœ€è¦å»äº†è§£å…¶ä¸­çš„ç»„ç»‡ç»“æ„ã€é…ç½®å’Œæ¨¡å—çš„ä½¿ç”¨ç­‰ã€‚</p><h2 id=\"å‡†å¤‡\"><a href=\"#å‡†å¤‡\" class=\"headerlink\" title=\"å‡†å¤‡\"></a>å‡†å¤‡</h2><p>æ²¡æœ‰ä¸€ç‚¹ç›¸å…³ç»éªŒï¼Œå…ˆæŠŠ<code>vue-cli</code>ç”Ÿæˆåçš„<code>test/unit</code>ç›®å½•æ‹¿åˆ°è‡ªå·±çš„é¡¹ç›®ä¸­ã€‚<br>","content":"<p>æœ€è¿‘åœ¨æ­å»ºä¸€ä¸ªé¡¹ç›®çš„å‰ç«¯å¼€å‘ç¯å¢ƒï¼Œå‡†å¤‡è¶æ­¤æŠŠä¸€äº›æ²¡ç”¨è¿‡çš„ä¸œè¥¿å°è¯•ä¸‹ï¼Œæ¯”å¦‚ï¼šå•å…ƒæµ‹è¯•ã€‚<br>ä½¿ç”¨<code>vue-cli</code>å¯ä»¥ç›´æ¥ç”Ÿæˆä¸€ä¸ªåŒ…å«<code>unit</code>ã€<code>e2e</code>æµ‹è¯•çš„å¼€å‘ç¯å¢ƒï¼Œä¸è¿‡è¿˜æ˜¯éœ€è¦å»äº†è§£å…¶ä¸­çš„ç»„ç»‡ç»“æ„ã€é…ç½®å’Œæ¨¡å—çš„ä½¿ç”¨ç­‰ã€‚</p><h2 id=\"å‡†å¤‡\"><a href=\"#å‡†å¤‡\" class=\"headerlink\" title=\"å‡†å¤‡\"></a>å‡†å¤‡</h2><p>æ²¡æœ‰ä¸€ç‚¹ç›¸å…³ç»éªŒï¼Œå…ˆæŠŠ<code>vue-cli</code>ç”Ÿæˆåçš„<code>test/unit</code>ç›®å½•æ‹¿åˆ°è‡ªå·±çš„é¡¹ç›®ä¸­ã€‚<br><a id=\"more\"></a></p><p><code>test</code> ç›®å½•ç»“æ„:</p><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><div class=\"line\">â””â”€ test</div><div class=\"line\">    â””â”€ unit</div><div class=\"line\">        â”œâ”€ specs</div><div class=\"line\">        â”œâ”€ .eslintrc</div><div class=\"line\">        â”œâ”€ index.js</div><div class=\"line\">        â””â”€ karma.conf.js</div></pre></td></tr></table></figure><p>ä¹‹ååœ¨<code>package.json</code>ä¸­æ‰¾åˆ°<code>karma</code>ç›¸å…³çš„æ¨¡å—ã€‚</p><ul><li><a href=\"http://karma-runner.github.io/0.13/index.html\" target=\"_blank\" rel=\"external\">karma</a> ä¸€ä¸ª JavaScript æµ‹è¯•è¿è¡Œå™¨ï¼Œå…¶åœ¨æµ‹è¯•ä¸­çš„ä½œç”¨ç›¸å½“äºå¼€å‘æ„å»ºä¸­ä½¿ç”¨çš„<code>webpack</code>ã€‚</li><li><a href=\"https://github.com/webpack/karma-webpack\" target=\"_blank\" rel=\"external\">karma-webpack</a> è¿æ¥<code>karma</code>å’Œ<code>webpack</code>çš„æ¡¥æ¢ã€‚ä¸ç»è¿‡<code>webpack</code>ç¼–è¯‘å‘½ä»¤æ˜¯æ–‡ä»¶æ˜¯æ— æ³•ç‹¬ç«‹è¿è¡Œçš„ï¼Œ<code>karma</code>éœ€è¦äº†è§£ä½ çš„<code>webpack</code>é…ç½®ï¼Œå†³å®šå¦‚ä½•å¤„ç†ä½ çš„æµ‹è¯•æ–‡ä»¶ã€‚</li><li><a href=\"https://github.com/karma-runner/karma-phantomjs-launcher\" target=\"_blank\" rel=\"external\">karma-phantomjs-launcher</a> æ˜¯<code>phantomjs</code>åœ¨<code>karma</code>ä¸­çš„å¯åŠ¨å™¨ï¼Œç”±æ­¤å¼•å‡ºäº†<code>phantomjs</code>ã€‚<a href=\"https://github.com/ariya/phantomjs\" target=\"_blank\" rel=\"external\">PhantomJS</a> æ˜¯ä¸€ä¸ªæ²¡æœ‰ç•Œé¢çš„ â€œæµè§ˆå™¨â€ ï¼Œå†…ç½®äº† JavaScript APIï¼Œæ”¯æŒå„ç§Webæ ‡å‡†ï¼šDOM å¤„ç†ã€CSS é€‰æ‹©å™¨ã€JSONã€Canvas å’Œ SVG ç­‰ã€‚åœ¨æŸ¥æ‰¾ç›¸å…³èµ„æ–™æ—¶ï¼Œä¹Ÿå‘ç°äº†å…¶ä»–çš„å¸¸è§„æµè§ˆå™¨<code>launcher</code>ï¼Œæ¯”å¦‚ï¼šChromeã€Firefoxã€Safariã€IE ç­‰ï¼Œä»¥åº”å¯¹ä¸åŒæµè§ˆå™¨æˆ–å¤šæµè§ˆå™¨çš„æµ‹è¯•éœ€æ±‚ã€‚è§<a href=\"http://karma-runner.github.io/0.13/config/browsers.html\" target=\"_blank\" rel=\"external\">Browsers</a></li><li><a href=\"https://github.com/demerzel3/karma-sourcemap-loader\" target=\"_blank\" rel=\"external\">karma-sourcemap-loader</a> <code>Karma</code>æ’ä»¶ï¼Œç”Ÿæˆæ–‡ä»¶çš„<code>sourcemap</code>ã€‚</li><li><a href=\"https://github.com/karma-runner/karma-mocha\" target=\"_blank\" rel=\"external\">karma-mocha</a> è®©ä½ åœ¨ karma ä¸­ä½¿ç”¨ <a href=\"https://mochajs.org/\" target=\"_blank\" rel=\"external\">Mocha</a> æµ‹è¯•æ¡†æ¶çš„æ’ä»¶ï¼Œä½¿ç”¨æ—¶è¿˜éœ€è¦å®‰è£…å‰ç½®ä¾èµ–<code>mocha</code>ã€‚</li><li><a href=\"https://github.com/domenic/sinon-chai\" target=\"_blank\" rel=\"external\">karma-sinon-chai</a> è®©ä½ åœ¨<code>karma</code>ä¸­ä½¿ç”¨<code>sinon-chai</code>æ–­è¨€åº“çš„æ’ä»¶ï¼Œå‰ç½®ä¾èµ–æœ‰<code>sinon-chai</code>ã€<code>sinon</code>ã€<code>chai</code>â€¦ğŸ˜•</li><li><a href=\"https://github.com/mlex/karma-spec-reporter\" target=\"_blank\" rel=\"external\">karma-spec-reporter</a> ç”¨äºå°†æµ‹è¯•ç»“æœæ˜¾ç¤ºåˆ°æ§åˆ¶å°ã€‚</li><li><a href=\"https://github.com/karma-runner/karma-coverage\" target=\"_blank\" rel=\"external\">karma-coverage</a> ç”Ÿæˆä»£ç è¦†ç›–ç‡ã€‚</li></ul><p>å…¶ä¸­è¦ä½¿ç”¨<code>karma-phantomjs-launcher</code>ï¼Œéœ€è¦å…ˆå®‰è£…<code>PhantomJS</code>ï¼Œé€šè¿‡<code>phantomjs-prebuilt</code>å®‰è£…ã€‚</p><p>çœ‹åˆ°è¿™ä¸€å¤§å †ä¾èµ–ï¼Œæ„Ÿè§‰é¢å‰åˆæ˜¯ä¸€ä¸ªä¸äºšäº Webpack çš„æŠ€æœ¯æ ˆã€‚ä¹‹æ‰€ä»¥å»äº†è§£æ¯ä¸ªæ¨¡å—çš„ç”¨å¤„ï¼Œå°±æ˜¯ä¸ºäº†åœ¨å­¦ä¹ çš„æ—¶å€™ç›´æ’å¿ƒè„ï¼Œå¿½ç•¥é‚£äº›ä¸é‡è¦çš„æ¨¡å—ã€‚<br>ä»¥ä¸Šæ¥è¯´ï¼ŒKarma æ˜¯åŸºæœ¬çš„è¿è¡Œå™¨ï¼Œéœ€è¦äº†è§£å…¶é…ç½®å’Œä½¿ç”¨ã€‚æµ‹è¯•æ¡†æ¶ Mocha å’Œæ–­è¨€åº“ sinon-chai ç±»ä¼¼äºå¼€å‘ä¸­ä½¿ç”¨çš„ Lodashï¼Œæä¾›ä¸€ç³»åˆ—ç”¨äºæµ‹è¯•çš„å·¥å…·å‡½æ•°ã€‚å‰©ä¸‹çš„æŒ‰ç¤ºä¾‹é›†æˆå°±å¥½ã€‚</p><h2 id=\"å®‰è£…\"><a href=\"#å®‰è£…\" class=\"headerlink\" title=\"å®‰è£…\"></a>å®‰è£…</h2><p>æ•´åˆä¸€æ¡å‘½ä»¤ã€‚</p><figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><div class=\"line\">npm i -D karma karma-webpack phantomjs-prebuilt karma-phantomjs-launcher karma-sourcemap-loader mocha karma-mocha sinon chai sinon-chai karma-sinon-chai karma-spec-reporter karma-coverage</div></pre></td></tr></table></figure><p>PhantomJS å®‰è£…æ¯”è¾ƒæ…¢ï¼Œä¹Ÿå¯ä»¥å»å…¶<a href=\"http://phantomjs.org/download.html\" target=\"_blank\" rel=\"external\">å®˜ç½‘ä¸‹è½½</a>ï¼Œå¹¶æ‰‹åŠ¨<a href=\"http://phantomjs.org/build.html\" target=\"_blank\" rel=\"external\">é…ç½®ç¯å¢ƒå˜é‡</a>ã€‚</p><p>å®‰è£…å¥½äº†ï¼Œå…ˆè·‘ä¸€ä¸‹çœ‹çœ‹æ˜¯å¦å®‰è£…æ­£ç¡®ï¼Œåˆ°<code>package.json</code>çš„<code>scripts</code>ä¸­æ³¨å†Œä¸€ä¸ªå‘½ä»¤ï¼š<code>&quot;unit&quot;: &quot;karma start test/unit/karma.conf.js --single-run&quot;</code>ï¼Œç„¶åè¿è¡Œã€‚</p><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><div class=\"line\">npm run unit</div></pre></td></tr></table></figure><p>ç„¶åä¸å‡ºæ„æ–™çš„æŠ¥é”™äº†ï¼Œåªæ˜¯å°‘è£…äº†ä¸€ä¸ªæ¨¡å—<code>isparta-loader</code>ï¼Œæ˜¯ä¸€ä¸ªä»£ç è¦†ç›–å·¥å…·ï¼Œç»§ç»­å®‰è£…åè¿è¡ŒOKã€‚</p><figure class=\"image-bubble\"><div class=\"img-lightbox\"><div class=\"overlay\"></div><img src=\"http://static.imys.net/vue-unit-1.jpg\" alt=\"vue-unit-1\"></div><div class=\"image-caption\">vue-unit-1</div></figure><h2 id=\"é…ç½®\"><a href=\"#é…ç½®\" class=\"headerlink\" title=\"é…ç½®\"></a>é…ç½®</h2><p>karma.conf.js æ–‡ä»¶å†…å®¹åˆ†ä¸ºä¸¤éƒ¨åˆ†ã€‚<br><code>module.exports</code> ä»¥ä¸Šæ˜¯å¯¹ Webpack é…ç½®çš„å¤„ç†ï¼Œåƒ<code>webpack.dev.conf</code>å’Œ<code>webpack.prod.conf</code>é‚£æ ·ï¼Œåœ¨ä¸åŒçš„ç¯å¢ƒé‡Œä½¿ç”¨ä¸åŒçš„é…ç½®ã€‚åä¸€éƒ¨åˆ†å°±æ˜¯å¯¹ Karma çš„é…ç½®äº†ã€‚</p><figure class=\"highlight js\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"built_in\">module</span>.exports = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">config</span>) </span>&#123;</div><div class=\"line\">    config.set(&#123;</div><div class=\"line\">        <span class=\"comment\">// è¦å¯åŠ¨çš„æµ‹è¯•æµè§ˆå™¨</span></div><div class=\"line\">        browsers: [<span class=\"string\">'PhantomJS'</span>],</div><div class=\"line\">        <span class=\"comment\">// æµ‹è¯•æ¡†æ¶</span></div><div class=\"line\">        frameworks: [<span class=\"string\">'mocha'</span>, <span class=\"string\">'sinon-chai'</span>],</div><div class=\"line\">        <span class=\"comment\">// æµ‹è¯•æŠ¥å‘Šå¤„ç†</span></div><div class=\"line\">        reporters: [<span class=\"string\">'spec'</span>, <span class=\"string\">'coverage'</span>],</div><div class=\"line\">        <span class=\"comment\">// è¦æµ‹è¯•çš„ç›®æ ‡æ–‡ä»¶</span></div><div class=\"line\">        files: [<span class=\"string\">'./index.js'</span>],</div><div class=\"line\">        <span class=\"comment\">// å¿½ç•¥çš„æ–‡ä»¶</span></div><div class=\"line\">        exclude: [],</div><div class=\"line\">        <span class=\"comment\">// é¢„å¤„ç†æ–‡ä»¶</span></div><div class=\"line\">        preprocessors: &#123;</div><div class=\"line\">            <span class=\"string\">'./index.js'</span>: [<span class=\"string\">'webpack'</span>, <span class=\"string\">'sourcemap'</span>]</div><div class=\"line\">        &#125;,</div><div class=\"line\">        <span class=\"comment\">// webpack</span></div><div class=\"line\">        webpack: webpackConfig,</div><div class=\"line\">        <span class=\"attr\">webpackMiddleware</span>: &#123;</div><div class=\"line\">            <span class=\"attr\">noInfo</span>: <span class=\"literal\">true</span></div><div class=\"line\">        &#125;,</div><div class=\"line\">        <span class=\"comment\">// Coverage options</span></div><div class=\"line\">        coverageReporter: &#123;</div><div class=\"line\">            <span class=\"attr\">dir</span>: <span class=\"string\">'./coverage'</span>,</div><div class=\"line\">            <span class=\"attr\">reporters</span>: [</div><div class=\"line\">                &#123; <span class=\"attr\">type</span>: <span class=\"string\">'lcov'</span>, <span class=\"attr\">subdir</span>: <span class=\"string\">'.'</span> &#125;,</div><div class=\"line\">                &#123; <span class=\"attr\">type</span>: <span class=\"string\">'text-summary'</span> &#125;</div><div class=\"line\">            ]</div><div class=\"line\">        &#125;,</div><div class=\"line\">        <span class=\"comment\">// true: è‡ªåŠ¨è¿è¡Œæµ‹è¯•å¹¶é€€å‡º</span></div><div class=\"line\">        <span class=\"comment\">// false: ç›‘æ§æ–‡ä»¶æŒç»­æµ‹è¯•</span></div><div class=\"line\">        singleRun: <span class=\"literal\">true</span>,</div><div class=\"line\"></div><div class=\"line\">        <span class=\"comment\">// ä»¥ä¸‹æ˜¯ vue-cli æ²¡æœ‰ç”Ÿæˆçš„ä¸€äº›é…ç½®</span></div><div class=\"line\"></div><div class=\"line\">        <span class=\"comment\">// æ–‡ä»¶åŒ¹é…çš„èµ·å§‹è·¯å¾„</span></div><div class=\"line\">        <span class=\"comment\">// basePath: '',</span></div><div class=\"line\">        <span class=\"comment\">// æœåŠ¡å™¨ç«¯å£</span></div><div class=\"line\">        <span class=\"comment\">// port: 9876,</span></div><div class=\"line\">        <span class=\"comment\">// è¾“å‡ºç€è‰²</span></div><div class=\"line\">        <span class=\"comment\">// colors: true,</span></div><div class=\"line\">        <span class=\"comment\">// æ—¥å¿—çº§åˆ«</span></div><div class=\"line\">        <span class=\"comment\">// LOG_DISABLE || LOG_ERROR || LOG_WARN || LOG_INFO || LOG_DEBUG</span></div><div class=\"line\">        <span class=\"comment\">// logLevel: config.LOG_INFO,</span></div><div class=\"line\">        <span class=\"comment\">// ç›‘æ§æ–‡ä»¶æ›´æ”¹</span></div><div class=\"line\">        <span class=\"comment\">// autoWatch: true,</span></div><div class=\"line\">        <span class=\"comment\">// è¶…æ—¶å¤„ç†ï¼Œ6så†…æ²¡æœ‰æ•è·æµè§ˆå™¨å°†ç»ˆæ­¢è¿›ç¨‹</span></div><div class=\"line\">        <span class=\"comment\">// captureTimeout: 6000</span></div><div class=\"line\">    &#125;)</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure><p>å…¶ä¸­å¯¹äºæµ‹è¯•æ–‡ä»¶å…¥å£æœ‰ç‚¹éš¾ä»¥ç†è§£ï¼Œä»…ä»…æ˜¯ä¸€ä¸ªè„šæœ¬æ–‡ä»¶ï¼Œè€Œä¸æ˜¯è·¯å¾„åŒ¹é…ï¼Œä¹Ÿå°±æ˜¯é…ç½®æ–‡ä»¶åŒçº§çš„é‚£ä¸ª<code>index.js</code>ï¼Œåªæœ‰ 5 è¡Œä»£ç ã€‚</p><figure class=\"highlight js\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"built_in\">Function</span>.prototype.bind = <span class=\"built_in\">require</span>(<span class=\"string\">'function-bind'</span>)</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">const</span> testsContext = <span class=\"built_in\">require</span>.context(<span class=\"string\">'./specs'</span>, <span class=\"literal\">true</span>, /\\.spec$/)</div><div class=\"line\">testsContext.keys().forEach(testsContext)</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">const</span> srcContext = <span class=\"built_in\">require</span>.context(<span class=\"string\">'../../src'</span>, <span class=\"literal\">true</span>, /^\\.\\/(?!main(\\.js)?$)/)</div><div class=\"line\">srcContext.keys().forEach(srcContext)</div></pre></td></tr></table></figure><p>çœ‹èµ·æ¥å¦‚æœä½¿ç”¨äº†é«˜ç‰ˆæœ¬çš„ NodeJs ç¬¬ä¸€è¡Œä»£ç æ˜¯å¯ä»¥å»æ‰äº†ã€‚</p><ul><li><code>testsContext</code>åŒ¹é…çš„æ˜¯<code>specs</code>ç›®å½•ï¼Œé‡Œé¢æ˜¯å­˜æ”¾çš„æ˜¯æµ‹è¯•ç”¨ä¾‹ï¼›</li><li><code>srcContext</code>åŒ¹é…çš„æ˜¯<code>src</code>ç›®å½•ï¼Œä»æ­£åˆ™ä¸Šçœ‹æ˜¯é™¤äº†<code>main.js</code>ä»¥å¤–çš„æ‰€æœ‰æ–‡ä»¶ã€‚</li></ul><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œä¹Ÿå¯ä»¥é€šè¿‡è„šæœ¬æ–‡ä»¶è¿™ç§æ–¹å¼è®¾ç½®åŒ¹é…çš„ç›®æ ‡æ–‡ä»¶ã€‚</p><h2 id=\"å®è·µ\"><a href=\"#å®è·µ\" class=\"headerlink\" title=\"å®è·µ\"></a>å®è·µ</h2><p>ç°åœ¨çœ‹èµ·æ¥ä¸€åˆ‡å¦¥å½“äº†ï¼Œå¯ä»¥å¼€å§‹å†™æµ‹è¯•ç”¨ä¾‹äº†ã€‚</p><p>æŠŠä»¥ä¸Šæ­¥éª¤åˆé‡å¤äº†ä¸€éï¼Œé›†æˆåˆ°äº†ä¸€ä¸ªè‡ªå·±å†™çš„ Demo é¡¹ç›®ä¸­ï¼Œç„¶åè¿è¡Œæµ‹è¯•ã€‚</p><figure class=\"image-bubble\"><div class=\"img-lightbox\"><div class=\"overlay\"></div><img src=\"http://static.imys.net/vue-unit-2.jpg\" alt=\"vue-unit-2\"></div><div class=\"image-caption\">vue-unit-2</div></figure><p>ä»€ä¹ˆé¬¼ï¼Œæ‰¾ä¸åˆ° <code>less</code> å˜é‡ã€‚</p><p>ä¸ºäº†éªŒè¯ä¸æ˜¯é…ç½®é—®é¢˜ï¼Œæˆ‘åœ¨ vue-cli ç”Ÿæˆé¡¹ç›®çš„ç»„ä»¶ä¸­ä½¿ç”¨ less å†™äº†ä¸ªæ ·å¼ï¼Œè¿è¡Œæµ‹è¯•å‡ºç°äº†ä¸€æ ·çš„é—®é¢˜ã€‚<br>æœ€åæ‰¾åˆ°äº†è¿™æ¡<a href=\"https://github.com/vuejs-templates/webpack/issues/163\" target=\"_blank\" rel=\"external\">issue</a>ã€‚<br>ç¿»è¯‘äº†åŠå¤©ï¼Œæ„Ÿè§‰æ˜¯åŒ¹é…æ–‡ä»¶çš„é—®é¢˜ã€‚</p><figure class=\"highlight js\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">const</span> srcContext = <span class=\"built_in\">require</span>.context(<span class=\"string\">'../../src'</span>, <span class=\"literal\">true</span>, /^\\.\\/(?!main(\\.js)?$)/)</div></pre></td></tr></table></figure><p>åŸæ¥çš„æ­£åˆ™ä¼šåŒ¹é…é™¤äº†<code>main.js</code>ä»¥å¤–çš„æ‰€æœ‰æ–‡ä»¶ï¼Œæ‰€ä»¥æ ·å¼æ–‡ä»¶ä¹Ÿä¼šè¢«åŒ¹é…ä¸Šã€‚ä½¿ç”¨ less æ—¶ä¸€èˆ¬åªæœ‰ä¸€ä¸ªå˜é‡æ–‡ä»¶ï¼Œç„¶åä»ä¸€ä¸ª less å‡ºå£æ–‡ä»¶ä¸­è§£æï¼Œè€Œå•å…ƒæµ‹è¯•æœ¬èº«åšçš„å·¥ä½œæ˜¯å•æ–‡ä»¶æµ‹è¯•ï¼Œå•ä¸ª less æ–‡ä»¶è‚¯å®šæ˜¯æ‰¾ä¸åˆ°å˜é‡çš„ã€‚<br>ä¸è¿‡æ ·å¼æœ¬èº«æ˜¯ä¸ä¼šå¯¹é€»è¾‘äº§ç”Ÿå½±å“çš„ï¼Œå¯ä»¥ä¸å‚ä¸æµ‹è¯•ï¼Œå¹²è„†ç›´æ¥é”å®šç›®æ ‡æ–‡ä»¶åç¼€ï¼Œä¹Ÿå°±æ˜¯ vue ç»„ä»¶ã€‚</p><p>ä¿®æ”¹å¦‚ä¸‹ï¼š</p><figure class=\"highlight js\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">const</span> srcContext = <span class=\"built_in\">require</span>.context(<span class=\"string\">'../../src'</span>, <span class=\"literal\">true</span>, /\\.vue$/)</div></pre></td></tr></table></figure><p>åˆšç¿»è¿‡ä¸€åº§å±±ï¼Œåˆé‡åˆ°ä¸€æ¡æ²³ã€‚</p><figure class=\"image-bubble\"><div class=\"img-lightbox\"><div class=\"overlay\"></div><img src=\"http://static.imys.net/vue-unit-3.jpg\" alt=\"vue-unit-3\"></div><div class=\"image-caption\">vue-unit-3</div></figure><p>çœ‹èµ·æ¥æ˜¯å› ä¸º API ä¸å…¼å®¹ï¼ŒPhantomJS ä¸­è¿˜æ²¡æœ‰é›†æˆ Promiseã€‚</p><figure class=\"image-bubble\"><div class=\"img-lightbox\"><div class=\"overlay\"></div><img src=\"http://static.imys.net/vue-unit-4.jpg\" alt=\"vue-unit-4\"></div><div class=\"image-caption\">vue-unit-4</div></figure><p>ä¸ºäº†é¿å…ç›¸ä¼¼çš„é—®é¢˜ï¼Œç´¢æ€§æŠŠ launcher æ¢æ‰äº†ï¼Œç”¨<code>karma-chrome-launcher</code>ã€‚<br>å®‰è£…åï¼Œæ›´æ”¹ Karma é…ç½®ä¸­çš„<code>browsers</code>å±æ€§å€¼ä¸º<code>[&#39;Chrome&#39;]</code>ï¼Œæµ‹è¯•è¿è¡ŒæˆåŠŸã€‚</p><figure class=\"image-bubble\"><div class=\"img-lightbox\"><div class=\"overlay\"></div><img src=\"http://static.imys.net/vue-unit-5.png\" alt=\"vue-unit-5\"></div><div class=\"image-caption\">vue-unit-5</div></figure><p>æœ‰ä¸€äº›é’è‰²çš„ LOGï¼Œç¬¬ä¸€æ¡ä½¿ç”¨ Vue çš„åº”è¯¥éƒ½å·²ç»ç†Ÿæ‚‰äº†ï¼Œæ˜¯æµè§ˆå™¨æ§åˆ¶å°è¾“å‡ºçš„ LOGï¼Œæ‰€ä»¥å…¶ä»–çš„ä¹Ÿæ˜¯æµè§ˆå™¨çš„æ—¥å¿—äº†ã€‚</p><p>ç¬¬ 1ã€3ã€4 æ¡ LOG æ˜¯æœ‰ä¸€ä¸ªæŒ‡ä»¤æ²¡æœ‰æ‰¾åˆ°ï¼Œç¬¬ 2 æ¡æ˜¯å…³äºè·¯ç”±çš„ã€‚æŒ‡ä»¤å’Œè·¯ç”±çš„å¼•å…¥æ˜¯åœ¨é¡¹ç›®å…¥å£çš„ js æ–‡ä»¶å†…ï¼Œå¯ä»¥é¢„çŸ¥å¦‚æœæˆ‘ä½¿ç”¨äº†å…¶ä»–ç±»åˆ«çš„ Vue æ’ä»¶ä¹Ÿä¼šæŠ¥å‡º ERRORã€‚<br>è¿˜æ˜¯æœ‰é—®é¢˜è¦è§£å†³å•Šï¼ğŸ˜’</p><h2 id=\"æµ‹è¯•ç”¨ä¾‹\"><a href=\"#æµ‹è¯•ç”¨ä¾‹\" class=\"headerlink\" title=\"æµ‹è¯•ç”¨ä¾‹\"></a>æµ‹è¯•ç”¨ä¾‹</h2><p>åˆæ¬¡æ¥è§¦æµ‹è¯•æ¡†æ¶å’Œæ–­è¨€ï¼Œå¯¹äºç»„ä»¶çš„æµ‹è¯•ç”¨ä¾‹ä¹Ÿè¿˜åœ¨æ‘¸ç´¢ä¸­ã€‚<br>ä»ä¾‹å­ä¸Šçœ‹ï¼Œå¤§æ¦‚æ€è·¯å¦‚ä¸‹ï¼š</p><ol><li>å¼•å…¥ä¸€ä¸ªç»„ä»¶ï¼›</li><li>åˆ›å»ºä¸€ä¸ªç”¨äºæµ‹è¯•çš„ Vue å®ä¾‹ï¼Œç„¶åç»„ä»¶æŒ‚ä¸Šå»ï¼›</li><li>å¯¹å®ä¾‹è¿›è¡Œæ¨¡æ‹Ÿæ“ä½œï¼Œç„¶åæ–­è¨€æœŸæœ›å€¼ã€‚</li></ol><figure class=\"highlight js\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">import</span> Vue <span class=\"keyword\">from</span> <span class=\"string\">'vue'</span></div><div class=\"line\"><span class=\"keyword\">import</span> SearchView <span class=\"keyword\">from</span> <span class=\"string\">'src/components/SearchView'</span></div><div class=\"line\"></div><div class=\"line\">describe(<span class=\"string\">'SearchView.vue'</span>, () =&gt; &#123;</div><div class=\"line\">    it(<span class=\"string\">'Input is normal'</span>, () =&gt; &#123;</div><div class=\"line\">        <span class=\"keyword\">const</span> vm = <span class=\"keyword\">new</span> Vue(&#123;</div><div class=\"line\">            <span class=\"attr\">el</span>: <span class=\"built_in\">document</span>.createElement(<span class=\"string\">'div'</span>),</div><div class=\"line\">            <span class=\"attr\">render</span>: <span class=\"function\">(<span class=\"params\">h</span>) =&gt;</span> h(SearchView)</div><div class=\"line\">        &#125;)</div><div class=\"line\"></div><div class=\"line\">        vm.key = <span class=\"string\">'æ›¾ç»çš„ä½ '</span></div><div class=\"line\"></div><div class=\"line\">        vm.$nextTick(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</div><div class=\"line\">            expect(vm.$el.querySelector(<span class=\"string\">'.m-key'</span>).textContent).to.equal(<span class=\"string\">'æ›¾ç»çš„ä½ '</span>)</div><div class=\"line\">        &#125;)</div><div class=\"line\">    &#125;)</div><div class=\"line\">&#125;)</div></pre></td></tr></table></figure><p>å®é™…çš„é¡¹ç›®ä¸­ï¼Œé’ˆå¯¹å¤æ‚çš„é€»è¾‘æˆ–è€…å¼‚æ­¥æ“ä½œï¼Œæµ‹è¯•ä¸€å®šä¸ä¼šè¿™ä¹ˆç®€å•ã€‚ğŸ˜…<br>ä¸‹ä¸€æ­¥å‡†å¤‡æ‰¾ä¸€äº› Vue çš„å¼€æºé¡¹ç›®ï¼Œå­¦ä¹ ä¸€ä¸‹å…¶ä¸­çš„æµ‹è¯•ç”¨ä¾‹å†™æ³•ã€‚</p><p>End!</p>","categories":[],"tags":[{"name":"Vue","path":"api/tags/Vue.json"},{"name":"Unit test","path":"api/tags/Unit test.json"},{"name":"å•å…ƒæµ‹è¯•","path":"api/tags/å•å…ƒæµ‹è¯•.json"},{"name":"Karma","path":"api/tags/Karma.json"},{"name":"Phantomjs","path":"api/tags/Phantomjs.json"}]}