{"title":"Vueæœ€ä½³å®è·µ","slug":"vue-best-practices","date":"2018-03-20T12:18:51.000Z","updated":"2018-03-20T12:23:42.764Z","comments":true,"path":"api/articles/vue-best-practices.json","excerpt":"<blockquote><p>è®°å½•æˆ‘åœ¨ä½¿ç”¨ Vue ä¸­å‘ç°çš„ä¸€äº›å¥½çš„ä»£ç å®è·µï¼Œå¸Œæœ›èƒ½å¤Ÿä¿æŒæ›´æ–°ã€‚ğŸ¤ </p></blockquote>","content":"<blockquote><p>è®°å½•æˆ‘åœ¨ä½¿ç”¨ Vue ä¸­å‘ç°çš„ä¸€äº›å¥½çš„ä»£ç å®è·µï¼Œå¸Œæœ›èƒ½å¤Ÿä¿æŒæ›´æ–°ã€‚ğŸ¤ </p></blockquote><a id=\"more\"></a><h2 id=\"this-å¼•ç”¨\"><a href=\"#this-å¼•ç”¨\" class=\"headerlink\" title=\"this å¼•ç”¨\"></a>this å¼•ç”¨</h2><p>åœ¨ç»„ä»¶ä½œç”¨åŸŸå†…ä½¿ç”¨ç®­å¤´å‡½æ•°å¯ä»¥ä¿è¯ <code>this</code> æ°¸è¿œæŒ‡å‘ç»„ä»¶æœ¬èº«ã€‚</p><figure class=\"highlight js\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// bad</span></div><div class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> &#123;</div><div class=\"line\">    data() &#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> &#123;</div><div class=\"line\">            <span class=\"attr\">msg</span>: <span class=\"string\">'hello'</span></div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;,</div><div class=\"line\">    <span class=\"attr\">methods</span>: &#123;</div><div class=\"line\">        hello() &#123;</div><div class=\"line\">            setTimeout(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</div><div class=\"line\">                <span class=\"built_in\">console</span>.log(<span class=\"keyword\">this</span>.msg) <span class=\"comment\">// this æŒ‡å‘ window</span></div><div class=\"line\">            &#125;)</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure><figure class=\"highlight js\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// good</span></div><div class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> &#123;</div><div class=\"line\">    data() &#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> &#123;</div><div class=\"line\">            <span class=\"attr\">msg</span>: <span class=\"string\">'hello'</span></div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;,</div><div class=\"line\">    <span class=\"attr\">methods</span>: &#123;</div><div class=\"line\">        hello() &#123;</div><div class=\"line\">            setTimeout(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</div><div class=\"line\">                <span class=\"built_in\">console</span>.log(<span class=\"keyword\">this</span>.msg) <span class=\"comment\">// this æŒ‡å‘ç»„ä»¶</span></div><div class=\"line\">            &#125;)</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure><h2 id=\"å±æ€§ç»‘å®š\"><a href=\"#å±æ€§ç»‘å®š\" class=\"headerlink\" title=\"å±æ€§ç»‘å®š\"></a>å±æ€§ç»‘å®š</h2><p>ç»‘å®šå­—ç¬¦ä¸²ä¸éœ€è¦åŠ å†’å·ã€‚</p><figure class=\"highlight html\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">&lt;!-- bad --&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">component</span> <span class=\"attr\">:str</span>=<span class=\"string\">\"'hello'\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">component</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">&lt;!-- good --&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">component</span> <span class=\"attr\">str</span>=<span class=\"string\">\"hello\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">component</span>&gt;</span></div></pre></td></tr></table></figure><p>å¸ƒå°”å±æ€§çœç•¥å€¼æ—¶é»˜è®¤ä¸º <code>true</code>ã€‚</p><figure class=\"highlight html\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">my-modal</span> <span class=\"attr\">visible</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">my-modal</span>&gt;</span></div><div class=\"line\"><span class=\"comment\">&lt;!--ç­‰ä»·äº--&gt;</span></div><div class=\"line\"><span class=\"comment\">&lt;!--&lt;my-modal :visible=\"true\"&gt;&lt;/my-modal&gt;--&gt;</span></div></pre></td></tr></table></figure><p>ç»‘å®šæ— å‚å‡½æ•°ä¸éœ€è¦åŠ æ‹¬å·ã€‚</p><figure class=\"highlight html\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">&lt;!-- badï¼Œæ‹¬å·å¤šä½™ --&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">\"onClick()\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">&lt;!-- goodï¼Œéšå¼ä¼ é€’äº† event å¯¹è±¡ --&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">\"onClick\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></div></pre></td></tr></table></figure><p>åªæœ‰ä¸€è¡Œä»£ç çš„äº‹ä»¶å‡½æ•°ï¼Œå¯ä»¥ç›´æ¥å†™æ ‡ç­¾ä¸Šã€‚</p><figure class=\"highlight html\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click</span>=<span class=\"string\">\"visible = true\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></div></pre></td></tr></table></figure><h2 id=\"åŒå‘ç»‘å®š\"><a href=\"#åŒå‘ç»‘å®š\" class=\"headerlink\" title=\"åŒå‘ç»‘å®š\"></a>åŒå‘ç»‘å®š</h2><p>è¡¨å•ç»„ä»¶ä¸€èˆ¬éƒ½æ”¯æŒåŒå‘ç»‘å®šï¼Œå®é™…åœºæ™¯ä¸­è¡¨å•ç»„ä»¶å€¼å‘ç”Ÿå˜åŒ–å¾€å¾€è¦åœ¨ <code>POST or PUT</code> è¯·æ±‚ä¹‹åã€‚å¦‚æœç›´æ¥åœ¨ <code>v-model</code> ç»‘å®šåŸå§‹å€¼å¾€å¾€ä¼šæ‰“ç ´å•å‘æ•°æ®æµã€‚</p><p>ä½¿ç”¨è®¡ç®—å±æ€§çš„ <code>get/set</code> æ–¹å¼å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ï¼ˆä¹Ÿé€‚ç”¨ <code>.sync</code>ï¼‰</p><figure class=\"highlight js\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> &#123;</div><div class=\"line\">    <span class=\"attr\">template</span>: <span class=\"string\">`&lt;div&gt;</span></div><div class=\"line\">        &lt;input type=\"radio\" v-model=\"nameVal\" value=\"1\"&gt;</div><div class=\"line\">        &lt;input type=\"radio\" v-model=\"nameVal\" value=\"2\"&gt;</div><div class=\"line\">        &lt;/div&gt;</div><div class=\"line\">    `,</div><div class=\"line\">    data() &#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> &#123;</div><div class=\"line\">            <span class=\"attr\">name</span>: <span class=\"string\">''</span></div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;,</div><div class=\"line\">    <span class=\"attr\">computed</span>: &#123;</div><div class=\"line\">        <span class=\"attr\">nameVal</span>: &#123;</div><div class=\"line\">            get() &#123;</div><div class=\"line\">                <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.name</div><div class=\"line\">            &#125;,</div><div class=\"line\">            set(val) &#123;</div><div class=\"line\">                <span class=\"keyword\">this</span>.edit(val)</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;,</div><div class=\"line\">    <span class=\"attr\">methods</span>: &#123;</div><div class=\"line\">        edit(name) &#123;</div><div class=\"line\">            <span class=\"keyword\">this</span>.$http</div><div class=\"line\">                .put(<span class=\"string\">'/name'</span>, &#123;</div><div class=\"line\">                    name</div><div class=\"line\">                &#125;)</div><div class=\"line\">                .then(<span class=\"function\"><span class=\"params\">data</span> =&gt;</span> &#123;</div><div class=\"line\">                    <span class=\"keyword\">this</span>.name = name</div><div class=\"line\">                &#125;)</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;,</div><div class=\"line\">    created() &#123;</div><div class=\"line\">        <span class=\"keyword\">this</span>.$http.get(<span class=\"string\">'/name'</span>).then(<span class=\"function\"><span class=\"params\">data</span> =&gt;</span> &#123;</div><div class=\"line\">            <span class=\"keyword\">this</span>.name = data.name</div><div class=\"line\">        &#125;)</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure><h2 id=\"é‡Šæ”¾èµ„æº\"><a href=\"#é‡Šæ”¾èµ„æº\" class=\"headerlink\" title=\"é‡Šæ”¾èµ„æº\"></a>é‡Šæ”¾èµ„æº</h2><p>å–„ç”¨ <code>destory</code> é‡Šæ”¾åŸç”Ÿäº‹ä»¶ã€ç¬¬ä¸‰æ–¹ç»„ä»¶ã€å…¨å±€äº‹ä»¶æ€»çº¿ç­‰ã€‚</p><figure class=\"highlight js\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">import</span> bus <span class=\"keyword\">from</span> <span class=\"string\">'event-bus'</span></div><div class=\"line\"><span class=\"keyword\">import</span> plugin <span class=\"keyword\">from</span> <span class=\"string\">'plugin'</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> &#123;</div><div class=\"line\">    <span class=\"comment\">// ...</span></div><div class=\"line\">    created() &#123;</div><div class=\"line\">        bus.$on(<span class=\"string\">'hello'</span>, <span class=\"keyword\">this</span>.hello) <span class=\"comment\">// æ³¨å†Œå…¨å±€äº‹ä»¶</span></div><div class=\"line\">        <span class=\"built_in\">window</span>.addEventListener(<span class=\"string\">'resize'</span>, <span class=\"keyword\">this</span>.onResize) <span class=\"comment\">// DOM äº‹ä»¶</span></div><div class=\"line\">        plugin.init() <span class=\"comment\">// ç¬¬ä¸‰æ–¹ç»„ä»¶åˆå§‹åŒ–</span></div><div class=\"line\">    &#125;,</div><div class=\"line\">    destoryed() &#123;</div><div class=\"line\">        bus.$off(<span class=\"string\">'hello'</span>, <span class=\"keyword\">this</span>.hello)</div><div class=\"line\">        <span class=\"built_in\">window</span>.removeEventListener(<span class=\"string\">'resize'</span>, <span class=\"keyword\">this</span>.onResize)</div><div class=\"line\">        plugin.destory()</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure><h2 id=\"ä¿®é¥°ç¬¦\"><a href=\"#ä¿®é¥°ç¬¦\" class=\"headerlink\" title=\"ä¿®é¥°ç¬¦\"></a>ä¿®é¥°ç¬¦</h2><p>Vue å†…ç½®äº†è®¸å¤šå¸¸ç”¨ä¿®é¥°ç¬¦å¯ä»¥è®©ä½ å°‘å†™å‡ è¡Œä»£ç ï¼Œæé«˜å¼€å‘æ•ˆç‡ã€‚</p><figure class=\"highlight html\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">&lt;!-- è¾“å…¥å­—ç¬¦ä¸²è½¬æ•°å­— --&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text\"</span> <span class=\"attr\">v-model.number</span>=<span class=\"string\">\"value\"</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">&lt;!-- è¾“å…¥å­—ç¬¦ä¸²å»å‰åç©ºæ ¼ --&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text\"</span> <span class=\"attr\">v-model.trim</span>=<span class=\"string\">\"value\"</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">&lt;!-- ç›‘å¬é¼ æ ‡æŒ‰é”®ï¼Œæ”¯æŒ left, right, middle --&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click.left</span>=<span class=\"string\">\"onLeftClick\"</span>&gt;</span>ç‚¹å‡»é¼ æ ‡å·¦é”®<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click.right</span>=<span class=\"string\">\"onRightClick\"</span>&gt;</span>ç‚¹å‡»é¼ æ ‡å³é”®<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">&lt;!-- åœæ­¢å†’æ³¡ï¼Œé˜»æ­¢é»˜è®¤è¡Œä¸º --&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click.stop.prevent</span>=<span class=\"string\">\"doThis\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">&lt;!-- é”®ç›˜æŒ‰ä¸‹ç¡®è®¤é”®ï¼Œæ”¯æŒ keycode å’Œé”®åˆ«å --&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">input</span> @<span class=\"attr\">keyup.13</span>=<span class=\"string\">\"onEnter\"</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">&lt;!-- åªæ‰§è¡Œä¸€æ¬¡äº‹ä»¶ --&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">button</span> @<span class=\"attr\">click.once</span>=<span class=\"string\">\"doThis\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">&lt;!-- ç›‘å¬åŸç”Ÿäº‹ä»¶ --&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">el-button</span> @<span class=\"attr\">click.native</span>=<span class=\"string\">\"doThis\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">el-button</span>&gt;</span></div></pre></td></tr></table></figure><p>ä»¥ä¸Šæ˜¯ä¸€äº›å¸¸ç”¨çš„ä¿®é¥°ç¬¦ï¼Œæ›´å¤šç”¨æ³•å¯ä»¥å»æ–‡æ¡£ä¸Šæ‰¾æ‰¾ã€‚</p><h2 id=\"æ•°æ®è¯·æ±‚\"><a href=\"#æ•°æ®è¯·æ±‚\" class=\"headerlink\" title=\"æ•°æ®è¯·æ±‚\"></a>æ•°æ®è¯·æ±‚</h2><p>åˆ‡æ¢è·¯ç”±è¯·æ±‚æ•°æ®æ—¶ï¼Œä¸€èˆ¬éƒ½éœ€è¦å…¼å®¹ä¸¤ç§è§†å›¾æ‰“å¼€æ–¹å¼ï¼šè·¯ç”±è·³è½¬å’Œç›´æ¥ URL è¾“å…¥ã€‚</p><figure class=\"highlight js\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> &#123;</div><div class=\"line\">    <span class=\"attr\">watch</span>: &#123;</div><div class=\"line\">        $route() &#123;</div><div class=\"line\">            <span class=\"keyword\">this</span>.fetchData()</div><div class=\"line\">        &#125;,</div><div class=\"line\">    &#125;,</div><div class=\"line\">    methods() &#123;</div><div class=\"line\">        fetchData() &#123;</div><div class=\"line\">            <span class=\"comment\">// é¿å…é‡å¤è¯·æ±‚</span></div><div class=\"line\">            <span class=\"keyword\">if</span>(<span class=\"keyword\">this</span>.isLoading) <span class=\"keyword\">return</span></div><div class=\"line\">            <span class=\"keyword\">this</span>.isLoading = <span class=\"literal\">true</span></div><div class=\"line\">            <span class=\"comment\">// è¯·æ±‚æ•°æ®</span></div><div class=\"line\">            <span class=\"comment\">// ajax...</span></div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;,</div><div class=\"line\">    created() &#123;</div><div class=\"line\">        <span class=\"keyword\">this</span>.fetchData()</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure><p>è·¯ç”±è·³è½¬ä¼šè§¦å‘ <code>watch -&gt; $route</code>ï¼Œå¦‚æœæ˜¯æœªåˆ›å»ºçš„ç»„ä»¶è¿˜ä¼šè§¦å‘ <code>create</code>ï¼Œç›´æ¥ URL åªä¼šè§¦å‘ <code>created</code> é’©å­ã€‚ä¸€èˆ¬åœ¨ä¸¤ä¸ªä½ç½®éƒ½æ‰§è¡Œæ•°æ®è¯·æ±‚ï¼Œå†é€šè¿‡åˆ¤æ–­é¿å…é‡å¤è¯·æ±‚ï¼Œè¿˜å¯ä»¥åˆ©ç”¨ <code>isLoading</code> æ ‡è®°åšåŠ è½½åŠ¨ç”»ã€‚å¦‚æœä½¿ç”¨äº† <code>keep-alive</code>ï¼Œè¿˜éœ€è¦è€ƒè™‘ <code>activated</code> é’©å­ã€‚</p><h2 id=\"å‡å°‘åµŒå¥—å±‚çº§\"><a href=\"#å‡å°‘åµŒå¥—å±‚çº§\" class=\"headerlink\" title=\"å‡å°‘åµŒå¥—å±‚çº§\"></a>å‡å°‘åµŒå¥—å±‚çº§</h2><p>ç»„ä»¶å³ä½¿æœªåœ¨ <code>props</code> å£°æ˜ï¼Œä¹Ÿå¯ä»¥ä¼ é€’ä¸€äº›åŸç”Ÿ DOM å±æ€§ã€‚</p><figure class=\"highlight html\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">&lt;!-- bad --&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"content-view\"</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">router-view</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">router-view</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">&lt;!-- good --&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">router-view</span> <span class=\"attr\">class</span>=<span class=\"string\">\"content-view\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">router-view</span>&gt;</span></div></pre></td></tr></table></figure><p>å‘½åæ’æ§½ä¸­éœ€è¦æ”¾ç½®å¤šä¸ªå—æ—¶ï¼Œå¯ä»¥åˆ©ç”¨ <code>template</code> ç»„ä»¶ã€‚</p><figure class=\"highlight html\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">&lt;!-- bad --&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">my-component</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">slot</span>=<span class=\"string\">\"hello\"</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"block1\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"block2\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">my-component</span>&gt;</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">&lt;!-- good --&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">my-component</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">template</span> <span class=\"attr\">slot</span>=<span class=\"string\">\"hello\"</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"block1\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"block2\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">template</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">my-component</span>&gt;</span></div></pre></td></tr></table></figure><p>ä¸ç®¡æ˜¯å†…ç½®ç»„ä»¶è¿˜æ˜¯è‡ªå·±çš„ç»„ä»¶ï¼Œæœ‰æ—¶å€™ä¸éœ€è¦å¤šä¸€å±‚åŒ…è£¹å»æ·»åŠ æ ·å¼ï¼Œåè€Œå› æ­¤å¢åŠ äº†åµŒå¥—å±‚çº§ã€‚</p><h2 id=\"è¿‡æ»¤å™¨\"><a href=\"#è¿‡æ»¤å™¨\" class=\"headerlink\" title=\"è¿‡æ»¤å™¨\"></a>è¿‡æ»¤å™¨</h2><p>è¿‡æ»¤å™¨çš„æœ€ä½³åº”ç”¨åœºæ™¯åº”è¯¥æ˜¯å€¼çš„è½¬æ¢ï¼Œæ¯”å¦‚ï¼š<code>Date</code> ç±»å‹æ—¥æœŸè½¬å­—ç¬¦ä¸²ã€è´§å¸ã€å­—ç¬¦æˆªæ–­ã€markdown ç­‰ç­‰ã€‚</p><figure class=\"highlight js\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// æŒ‰é•¿åº¦æˆªæ–­æ–‡å­—ï¼Œè¡¥...ï¼Œä¸­æ–‡ = 2</span></div><div class=\"line\"><span class=\"keyword\">const</span> cnReg = <span class=\"regexp\">/[\\u4e00-\\u9fa5]/</span></div><div class=\"line\">Vue.filter(<span class=\"string\">'ellipsis'</span>, (str, len = <span class=\"number\">10</span>) =&gt; &#123;</div><div class=\"line\">    <span class=\"keyword\">let</span> i = <span class=\"number\">0</span></div><div class=\"line\">    <span class=\"keyword\">let</span> j = <span class=\"number\">0</span></div><div class=\"line\">    <span class=\"keyword\">let</span> ret = <span class=\"string\">''</span></div><div class=\"line\">    <span class=\"keyword\">const</span> text = <span class=\"built_in\">String</span>(str).trim()</div><div class=\"line\">    <span class=\"keyword\">const</span> max = text.length</div><div class=\"line\">    <span class=\"keyword\">while</span> (j &lt; max &amp;&amp; i &lt; len) &#123;</div><div class=\"line\">        <span class=\"keyword\">const</span> c = text.charAt(j)</div><div class=\"line\">        ret += c</div><div class=\"line\">        j += <span class=\"number\">1</span></div><div class=\"line\">        i = cnReg.test(c) ? i + <span class=\"number\">2</span> : i + <span class=\"number\">1</span></div><div class=\"line\">    &#125;</div><div class=\"line\">    <span class=\"keyword\">return</span> ret === text ? text : <span class=\"string\">`<span class=\"subst\">$&#123;ret&#125;</span>...`</span></div><div class=\"line\">&#125;)</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\">// æ—¥æœŸè½¬ç›¸å¯¹æ—¶é—´</span></div><div class=\"line\">Vue.filter(<span class=\"string\">'calendar'</span>, value =&gt; moment(value).calendar())</div></pre></td></tr></table></figure><h2 id=\"Props\"><a href=\"#Props\" class=\"headerlink\" title=\"Props\"></a>Props</h2><ul><li>å¸ƒå°”å±æ€§é»˜è®¤å€¼ä¸º <code>false</code> å¯ä»¥çœç•¥</li><li>æ•°ç»„æœ€å¥½å£°æ˜é»˜è®¤å€¼ <code>[]</code>ï¼Œä¿è¯æ•°æ®è¯·æ±‚æˆåŠŸå‰æ¨¡ç‰ˆé‡Œçš„ <code>v-for</code> ä¸ä¼šå‡ºé”™</li><li>å¯¹è±¡ä¹Ÿéœ€è¦æ³¨æ„æ˜¯å¦å£°æ˜äº†é»˜è®¤å€¼ <code>{}</code>ï¼Œé¿å…æ¨¡ç‰ˆä¸­ä½¿ç”¨ <code>obj.xx</code> æŠ¥é”™</li></ul><figure class=\"highlight js\"><table><tr><td class=\"code\"><pre><div class=\"line\">&#123;</div><div class=\"line\">    <span class=\"attr\">props</span>: &#123;</div><div class=\"line\">        <span class=\"attr\">visible</span>: Boolen, <span class=\"comment\">// é»˜è®¤å³ä¸º false</span></div><div class=\"line\">        data: <span class=\"built_in\">Array</span>,     <span class=\"comment\">// éœ€è¦è¿›è¡Œéç©ºåˆ¤æ–­</span></div><div class=\"line\">        data2: &#123;         <span class=\"comment\">// å¯å®‰å…¨ä½¿ç”¨ v-for</span></div><div class=\"line\">            type: <span class=\"built_in\">Array</span>,</div><div class=\"line\">            <span class=\"attr\">default</span>: []</div><div class=\"line\">        &#125;,</div><div class=\"line\">        <span class=\"attr\">obj</span>: <span class=\"built_in\">Object</span>,     <span class=\"comment\">// éœ€è¦è¿›è¡Œéç©ºåˆ¤æ–­</span></div><div class=\"line\">        obj2: &#123;          <span class=\"comment\">// å¯å®‰å…¨ä½¿ç”¨ obj.xx</span></div><div class=\"line\">            type: <span class=\"built_in\">Object</span>,</div><div class=\"line\">            <span class=\"keyword\">default</span>() &#123;</div><div class=\"line\">                <span class=\"keyword\">return</span> &#123;&#125;</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure><h2 id=\"v-if\"><a href=\"#v-if\" class=\"headerlink\" title=\"v-if\"></a>v-if</h2><p>å¦‚æœæ¨¡ç‰ˆä¸­ç»‘å®šäº† <code>obj.xx</code> æ—¶ï¼Œéœ€è¦æ³¨æ„ <code>obj</code> æ˜¯å¦æ˜¯å¼‚æ­¥æ•°æ®ï¼Œé»˜è®¤å€¼æ˜¯å¦ä¸º <code>null</code>ã€‚å®‰å…¨èµ·è§ï¼Œå¯åœ¨ç»„ä»¶æœ€å¤–å±‚åŠ  <code>v-if</code> åˆ¤æ–­ã€‚</p><figure class=\"highlight html\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">template</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">v-if</span>=<span class=\"string\">\"!!obj\"</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>&#123;&#123;obj.name&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span>&#123;&#123;obj.age&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">template</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"javascript\"></span></div><div class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> &#123;</div><div class=\"line\">    data() &#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> &#123;</div><div class=\"line\">            <span class=\"attr\">obj</span>: <span class=\"literal\">null</span></div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></div></pre></td></tr></table></figure><h2 id=\"è·¯ç”±\"><a href=\"#è·¯ç”±\" class=\"headerlink\" title=\"è·¯ç”±\"></a>è·¯ç”±</h2><p>å¯¹äºç»å¸¸å‘ç”Ÿå˜åŒ–çš„ä¸€çº§ã€äºŒçº§èœå•å¯¼èˆªï¼Œå¯ä»¥å’Œè·¯ç”±æ•°æ®ç»“åˆèµ·æ¥ï¼ŒæŒ‰æ¨¡å—åˆ’åˆ†ï¼Œè§†å›¾ç›´æ¥å¼•ç”¨å¯¹åº”æ¨¡å—çš„è·¯ç”±æ•°æ®æ¥ç”Ÿæˆå¯¼èˆªï¼Œå‡å°‘ç»´æŠ¤æˆæœ¬ã€‚</p><figure class=\"highlight js\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// routes.js</span></div><div class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> settingRoutes = []</div><div class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">const</span> userRoutes = []</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> [...settingRoutes, ...userRoutes]</div></pre></td></tr></table></figure><p>èœå•ç»„ä»¶ä¸­ï¼š</p><figure class=\"highlight html\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">template</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">ul</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">li</span> <span class=\"attr\">v-for</span>=<span class=\"string\">\"item in menus\"</span> <span class=\"attr\">:key</span>=<span class=\"string\">\"item.path\"</span>&gt;</span></div><div class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">router-link</span> <span class=\"attr\">:to</span>=<span class=\"string\">\"item\"</span>&gt;</span>&#123;&#123;item.text&#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">router-link</span>&gt;</span></div><div class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">ul</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">template</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"javascript\"></span></div><div class=\"line\"><span class=\"keyword\">import</span> &#123; settingRoutes &#125; <span class=\"keyword\">from</span> <span class=\"string\">'../routes'</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> &#123;</div><div class=\"line\">    data() &#123;</div><div class=\"line\">        <span class=\"attr\">menus</span>: settingRoutes</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></div></pre></td></tr></table></figure><h2 id=\"ç¬¬ä¸‰æ–¹åº“çš„é›†æˆ\"><a href=\"#ç¬¬ä¸‰æ–¹åº“çš„é›†æˆ\" class=\"headerlink\" title=\"ç¬¬ä¸‰æ–¹åº“çš„é›†æˆ\"></a>ç¬¬ä¸‰æ–¹åº“çš„é›†æˆ</h2><p>ç¬¬ä¸‰æ–¹åº“ä¸€èˆ¬æ˜¯ä¼ ç»Ÿçš„åŸºäº DOM å’ŒåŸç”Ÿ jsã€‚å®ƒä»¬è™½ç„¶å†™èµ·æ¥æ²¡æœ‰ä½¿ç”¨ä»»ä½•çš„ä»£ç æ¨¡ç‰ˆï¼Œä½†å‡ºäºä½œè€…çš„ç¼–ç¨‹ç»éªŒå…¶å®éƒ½ç¬¦åˆäº†å¤§ä¼—ä½¿ç”¨é¢„æœŸã€‚</p><p>ä»»ä½•ä¸€ä¸ªåº“ä¸€èˆ¬éƒ½ä¼šæä¾›ä»¥ä¸‹çš„æ¥å£ï¼š</p><ul><li>ä½¿ç”¨è‡ªå®šä¹‰é…ç½®åˆå§‹åŒ–</li><li>å¯è®¿é—®çš„å±æ€§</li><li>å¯è°ƒç”¨çš„åŠŸèƒ½å‡½æ•°</li><li>äº‹ä»¶ç»‘å®š</li><li>è‰¯å¥½çš„ç”Ÿå‘½å‘¨æœŸé’©å­</li></ul><blockquote><p>å¦‚æœæ²¡æœ‰è¶³å¤Ÿçš„ç¼–ç¨‹ç»éªŒç”¨åŸç”Ÿ js å»å†™ä¸€ä¸ªæ’ä»¶å¯èƒ½æœ€åå°±æ˜¯ä¸€å›¢ä¹±éº»ã€‚è¿™ä¹Ÿæ˜¯ Vue ç­‰ä¼—å¤šå‰ç«¯æ¡†æ¶çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œå®ƒä»¬çº¦æŸäº†ä¸€ä¸ªæ¨¡å—çš„ä»£ç æ¨¡ç‰ˆï¼Œæä¾›äº†äº‹ä»¶ç®¡ç†ã€ç”Ÿå‘½å‘¨æœŸè¿è¡Œã€å±æ€§å’Œå‡½æ•°çš„å®šä¹‰ï¼Œä½¿å³ä½¿ç»éªŒä¸è¶³çš„äººä¹Ÿèƒ½å†™å‡ºä¸€ä¸ªçœ‹å¾—è¿‡å»çš„æ¨¡å—ã€‚</p></blockquote><p>æŠŠç¬¬ä¸‰æ–¹åº“è½¬æ¢ä¸ºä¸€ä¸ª Vue ç»„ä»¶ï¼Œå…¶å®å°±æ˜¯æŠŠè¿™ä¸ªåº“çš„æ¥å£æŒ‚åˆ° Vue ç»„ä»¶å¯¹åº”çš„ç»„ä»¶é€‰é¡¹ä¸Šå»ã€‚</p><figure class=\"highlight js\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">import</span> Lib <span class=\"keyword\">from</span> <span class=\"string\">'lib'</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> &#123;</div><div class=\"line\">    <span class=\"attr\">props</span>: &#123;</div><div class=\"line\">        <span class=\"attr\">options</span>: <span class=\"built_in\">Object</span></div><div class=\"line\">    &#125;,</div><div class=\"line\">    data() &#123;</div><div class=\"line\">        <span class=\"keyword\">return</span> &#123;</div><div class=\"line\">            <span class=\"attr\">instance</span>: <span class=\"literal\">null</span></div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;,</div><div class=\"line\">    <span class=\"attr\">methods</span>: &#123;</div><div class=\"line\">        doSomething(xxx) &#123;</div><div class=\"line\">            <span class=\"comment\">// lib çš„æ“ä½œå‡½æ•°</span></div><div class=\"line\">            <span class=\"comment\">// å¤–éƒ¨ä½¿ç”¨ $refs è°ƒç”¨</span></div><div class=\"line\">            <span class=\"keyword\">this</span>.instance.doSomething(xxx)</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;,</div><div class=\"line\">    <span class=\"attr\">computed</span>: &#123;</div><div class=\"line\">        libProp() &#123;</div><div class=\"line\">            <span class=\"comment\">// lib çš„å¯è®¿é—®å±æ€§ä½¿ç”¨è®¡ç®—å±æ€§è®¿é—®</span></div><div class=\"line\">            <span class=\"comment\">// å¤–éƒ¨ä½¿ç”¨ $refs è°ƒç”¨</span></div><div class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.instance.prop</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;,</div><div class=\"line\">    <span class=\"attr\">watch</span>: &#123;</div><div class=\"line\">        options(val) &#123;</div><div class=\"line\">            <span class=\"comment\">// ç›‘å¬é…ç½®æ›´æ–°ï¼Œè°ƒç”¨ lib æ¥å£æ›´æ–°é…ç½®</span></div><div class=\"line\">            <span class=\"keyword\">if</span> (val) <span class=\"keyword\">this</span>.instance.updateOptions(val)</div><div class=\"line\">        &#125;</div><div class=\"line\">    &#125;,</div><div class=\"line\">    mounted() &#123;</div><div class=\"line\">        <span class=\"comment\">// mounted æˆ–è€… created å¯¹åº” lib å®ä¾‹åŒ–å¹¶ä¼ å…¥è‡ªå®šä¹‰é…ç½®</span></div><div class=\"line\">        <span class=\"keyword\">this</span>.instance = <span class=\"keyword\">new</span> Lib(<span class=\"keyword\">this</span>.$el, <span class=\"keyword\">this</span>.options)</div><div class=\"line\">        <span class=\"comment\">// lib å†…çš„äº‹ä»¶ $emit å‡ºå»ï¼Œå¤–éƒ¨ç›‘å¬</span></div><div class=\"line\">        <span class=\"keyword\">this</span>.instance.on(<span class=\"string\">'update'</span>, (...args) =&gt; &#123;</div><div class=\"line\">            <span class=\"keyword\">this</span>.$emit(<span class=\"string\">'update'</span>, ...args)</div><div class=\"line\">        &#125;)</div><div class=\"line\">    &#125;,</div><div class=\"line\">    destroyed() &#123;</div><div class=\"line\">        <span class=\"comment\">// lib å¦‚æœæä¾›äº† destroy ç­‰é”€æ¯èµ„æºçš„å‡½æ•°ä¸€èˆ¬éƒ½ä¼šå¯¹å…¶å†…éƒ¨çš„ DOM äº‹ä»¶è§£ç»‘</span></div><div class=\"line\">        <span class=\"keyword\">this</span>.instance.destroy()</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure><p>ä¹Ÿå¯èƒ½ä½ æƒ³æŠŠä¸€ä¸ªåº“å˜ä¸ºä¸€ä¸ª Vue æŒ‡ä»¤ã€‚</p><figure class=\"highlight js\"><table><tr><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">import</span> Lib <span class=\"keyword\">from</span> <span class=\"string\">'lib'</span></div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> &#123;</div><div class=\"line\">    install(Vue, option = &#123;&#125;) &#123;</div><div class=\"line\">        <span class=\"comment\">// å­˜æ”¾å…¨å±€é…ç½®</span></div><div class=\"line\">        <span class=\"keyword\">const</span> defaults = option</div><div class=\"line\"></div><div class=\"line\">        Vue.directive(<span class=\"string\">'my-directive'</span>, &#123;</div><div class=\"line\">            bind(el, &#123; value &#125;) &#123;</div><div class=\"line\">                <span class=\"comment\">// å½“å‰é…ç½®æ··åˆå…¨å±€é…ç½®</span></div><div class=\"line\">                <span class=\"keyword\">const</span> options = <span class=\"built_in\">Object</span>.assign(&#123;&#125;, defaults, value)</div><div class=\"line\">                <span class=\"keyword\">const</span> lib = <span class=\"keyword\">new</span> Lib(el, options)</div><div class=\"line\">                el._libInstace = lib <span class=\"comment\">// ç¼“å­˜ lib å®ä¾‹</span></div><div class=\"line\">            &#125;,</div><div class=\"line\">            update(el, &#123; value &#125;, vnode) &#123;</div><div class=\"line\">                <span class=\"comment\">// æ›´æ–° lib é…ç½®</span></div><div class=\"line\">                el._libInstace.setOptions(value)</div><div class=\"line\">            &#125;,</div><div class=\"line\">            unbind(el) &#123;</div><div class=\"line\">                <span class=\"comment\">// é”€æ¯ lib</span></div><div class=\"line\">                el._libInstace.destroy()</div><div class=\"line\">                <span class=\"keyword\">delete</span> el._libInstace</div><div class=\"line\">            &#125;</div><div class=\"line\">        &#125;)</div><div class=\"line\">    &#125;</div><div class=\"line\">&#125;</div></pre></td></tr></table></figure><p>æŒ‡ä»¤æœ‰ç€å®Œå–„çš„ç”Ÿå‘½å‘¨æœŸé’©å­ï¼Œä½†åœ¨æ•°æ®ç®¡ç†ä¸Šåå¼±ã€‚ä¸€èˆ¬ç”¨äºå•ä¸€åŠŸèƒ½çš„é›†æˆï¼Œæˆ–è€…åªéœ€è¦ä¸€æ¬¡åˆå§‹åŒ–çš„æ’ä»¶ã€‚</p><blockquote><p>æŒ‡ä»¤ä¸­å¯é€šè¿‡ <code>el</code> æˆ– <code>el.dataset</code> è¿›è¡Œç”Ÿå‘½å‘¨æœŸé—´çš„æ•°æ®å…±äº«ã€‚</p></blockquote>","categories":[],"tags":[{"name":"æŠ€å·§","path":"api/tags/æŠ€å·§.json"},{"name":"Vue","path":"api/tags/Vue.json"}]}